-- Function to add billboards to objects
local function trackObject(object, text, color)
    if object and not object:FindFirstChild(text) then
        local billboard = Instance.new("BillboardGui")
        billboard.Adornee = object
        billboard.Name = text
        billboard.Size = UDim2.new(0, 100, 0, 50)
        billboard.StudsOffset = Vector3.new(0, 2, 0)
        billboard.AlwaysOnTop = true
        billboard.Parent = object

        local textLabel = Instance.new("TextLabel")
        textLabel.Parent = billboard
        textLabel.BackgroundTransparency = 1
        textLabel.Size = UDim2.new(1, 0, 1, 0)
        textLabel.Font = Enum.Font.SourceSansBold
        textLabel.TextSize = 14
        textLabel.TextColor3 = color
        textLabel.TextStrokeTransparency = 0
        textLabel.TextYAlignment = Enum.TextYAlignment.Center
        textLabel.Text = text
        textLabel.ZIndex = 10
    end
end

-- Function to continuously track objects and ensure billboards remain intact
local function continuousTrack(objectContainer, objectName, displayName, color)
    while true do
        if objectContainer and objectContainer:FindFirstChild(objectName) then
            for _, obj in pairs(objectContainer:GetChildren()) do
                if obj.Name == objectName then
                    trackObject(obj, displayName, color)
                end
            end
        end
        wait(1) -- Check every 1 second to ensure billboards stay intact
    end
end

-- Check for Cursed Items before proceeding
local function checkCursedItems()
    local cursedItems = {}
    local cursedItemObjects = {}

    local ouijaBoard = game:GetService("Workspace"):FindFirstChild("Ouija Board")
    if ouijaBoard then
        table.insert(cursedItems, "Ouija Board")
        cursedItemObjects["Ouija Board"] = ouijaBoard
    end

    local summoningCircle = game:GetService("Workspace"):FindFirstChild("SummoningCircle")
    if summoningCircle then
        table.insert(cursedItems, "Summoning Circle")
        cursedItemObjects["Summoning Circle"] = summoningCircle
    end

    local tarotCards = game:GetService("Workspace").Map.Items:FindFirstChild("Tarot Cards")
    if tarotCards then
        local tarotCardHandle = tarotCards:FindFirstChild("Handle")
        if tarotCardHandle then
            table.insert(cursedItems, "Tarot Cards")
            cursedItemObjects["Tarot Cards"] = tarotCardHandle
        end
    end

    return cursedItems, cursedItemObjects
end

local cursedItems, cursedItemObjects = checkCursedItems()

if #cursedItems > 0 then
    for itemName, itemObject in pairs(cursedItemObjects) do
        local color = itemName == "Ouija Board" and Color3.fromRGB(0, 128, 0) or (itemName == "Summoning Circle" and Color3.fromRGB(255, 140, 0) or Color3.fromRGB(128, 0, 128))
        trackObject(itemObject, itemName, color)
    end
end

-- Set up lighting and other environmental effects
game:GetService("Lighting").Brightness = 2
game:GetService("Lighting").ClockTime = 0
game:GetService("Lighting").FogEnd = 100000
game:GetService("Lighting").GlobalShadows = false
game:GetService("Lighting").OutdoorAmbient = Color3.fromRGB(128, 128, 128)

local map = workspace:FindFirstChild("Map")
if map then
    -- Track Generators
    continuousTrack(map.Generators, "GeneratorMesh", "Generator", Color3.fromRGB(255, 0, 0))

    -- Track Orbs
    continuousTrack(map.Orbs, "OrbPart", "Orb", Color3.fromRGB(30, 144, 255))

    -- Track Prints
    continuousTrack(map.Prints, "UV_Hand", "Fingerprint", Color3.fromRGB(75, 0, 130))
else
    warn("Map not found in Workspace.")
end

-- Instant Proximity Prompt Script (runs immediately)
local ProximityPromptService = game:GetService("ProximityPromptService")

if fireproximityprompt then
    execCmd("uninstantproximityprompts")
    wait(0.1)
    ProximityPromptService.PromptButtonHoldBegan:Connect(function(prompt)
        fireproximityprompt(prompt)
    end)
    print("InstantPP ON")
else
    game.StarterGui:SetCore("SendNotification", {
        Title = "Incompatible Exploit",
        Text = "Your exploit does not support this command (missing fireproximityprompt)",
        Duration = 2
    })
end
